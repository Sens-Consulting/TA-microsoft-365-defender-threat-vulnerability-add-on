# Microsoft Advanced Hunting

This Technical Add-on uses the Microsoft Advanced Hunting API.

You can use two different API's:

- [Defender 365 API](https://docs.microsoft.com/en-us/microsoft-365/security/defender/api-advanced-hunting?view=o365-worldwide) `https://api.security.microsoft.com`
- [Defender for Endpoint](https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/run-advanced-query-api?view=o365-worldwide) `https://api.securitycenter.microsoft.com`

Usage:

1. Create and use the auth token from the registered enterprise application.
2. Run POST calls to the endpoint with a KQL `query` as input data.

Recommendations:

You should also be ingesting Defender for Endpoint data as well. We recommend using this add-on: 

- [Microsoft Defender for Endpoint Advanced Hunting Add-on for Splunk](https://github.com/splunk/TA-microsoft-365-defender-advanced-hunting-add-on)

## Troubleshooting

You can use [jwt.ms](https://jwt.ms/) to validate your auth token and that it has the correct `roles`
